function [rgb] = hsi2rgb(hsi)
    % expect hsi in format of HWC
    srf = [[0.00784314 0.00392157 0.00392157 0.00392157 0.00392157 0.00392157 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.00784314 0.02352941 0.04313725 0.06666667 0.08235294 0.08627451 0.08235294 0.07843137 0.07843137 0.0745098 0.0745098 0.07058824 0.07058824 0.06666667 0.06666667]
        [0.00492611 0.00492611 0.00492611 0.00492611 0.00492611 0.00492611 0.00985222 0.01970443 0.02955665 0.03940887 0.05418719 0.07881773 0.09359606 0.10344828 0.09852217 0.08866995 0.07881773 0.06896552 0.05418719 0.03448276 0.02463054 0.01477833 0.00985222 0.00985222 0.00492611 0.00492611 0.00985222 0.00985222 0.00985222 0.00985222 0.00985222]
        [0.02788845 0.03984064 0.05976096 0.07569721 0.09960159 0.11553785 0.11952191 0.11553785 0.10756972 0.0876494 0.06374502 0.03585657 0.00796813 0. 0. 0. 0. 0. 0. 0. 0.00398406 0.00398406 0.00398406 0.00398406 0.00398406 0.00398406 0.00398406 0.00398406 0.00398406 0.00398406 0.00398406]];
    [h w c] = size(hsi);
    tmp = reshape(hsi, [h * w c]);
    rgb = tmp * srf.';
    rgb = reshape(rgb, [h w 3]);
    rgb = (rgb - min(rgb(:))) ./ (max(rgb(:)) - min(rgb(:)));
